<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <title>Defects report</title>
    </head>
    <body>
        {{#each items}}
            <div class="page">
                <!-- ID + Process + Status -->
                <div class="d-flex mb-10">
                    <!-- CARD 1: ID + Status -->
                    <div class="w-33">
                        <div class="card card__bordered">
                            <div class="card__title fs-14" style="margin-right: 10px;">
                                Информация о замечании ID: {{this.id}}
                            </div>
                            {{#if (eq this.defectStatus "NEW")}}
                                <div class="status status-new">Новый</div>
                            {{else}}
                                {{#if (eq this.defectStatus "IN_PROGRESS")}}
                                    <div class="status status-in-progress">В процессе</div>
                                {{else}}
                                    {{#if (eq this.defectStatus "IN_REVIEW")}}
                                        <div class="status status-in-review">Проверка</div>
                                    {{else}}
                                        {{#if (eq this.defectStatus "NOT_FIXED")}}
                                            <div class="status status-not-fixed">Не устранено</div>
                                        {{else}}
                                            {{#if (eq this.defectStatus "FIXED")}}
                                                <div class="status status-fixed">Устранено</div>
                                            {{/if}}
                                        {{/if}}
                                    {{/if}}
                                {{/if}}
                            {{/if}}
                        </div>
                    </div>

                    <!-- CARD 2: Process Card -->
                    <div class="w-33">
                        <div class="card card__bordered">
                            <div class="card__title fs-10">На какой стадии находится замечание</div>
                            {{#with (defectProcessData this.defectStatus) as |process|}}
                                {{> defect-process options=process.options step=process.step isFailed=process.isFailed}}
                            {{/with}}
                        </div>
                    </div>

                    <!-- CARD 3: Status Card -->
                    <div class="w-33">
                        <div
                            class="card {{#if (eq this.defectStatus "NEW")}}card--new{{else}}{{#if (eq this.defectStatus "IN_PROGRESS")}}card--in-progress{{else}}{{#if (eq this.defectStatus "IN_REVIEW")}}card--in-review{{else}}{{#if (eq this.defectStatus "NOT_FIXED")}}card--not-fixed{{else}}{{#if (eq this.defectStatus "FIXED")}}card--fixed{{/if}}{{/if}}{{/if}}{{/if}}{{/if}}"
                            style="display: flex; align-items: center; column-gap: 8px;"
                        >
                            <div class="layer one">
                                <div class="layer second">
                                    <div class="layer third">
                                        <div class="layer fourth">
                                            {{#if (eq this.defectStatus "NEW")}}
                                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M16.6226 4.87106L15.9111 5.10823L15.9111 5.10823L16.6226 4.87106ZM15.9539 5.23652C16.0848 5.62948 16.5096 5.84185 16.9025 5.71086C17.2955 5.57987 17.5079 5.15513 17.3769 4.76218L16.6654 4.99935L15.9539 5.23652ZM13.5692 0.954503C13.1762 0.823517 12.7515 1.03589 12.6205 1.42884C12.4895 1.8218 12.7019 2.24654 13.0949 2.37753L13.332 1.66602L13.5692 0.954503ZM13.4603 1.70878L13.2232 2.42029V2.42029L13.4603 1.70878ZM3.71161 12.3994L3.14004 11.9138H3.14004L3.71161 12.3994ZM4.44433 10.6981L3.6991 10.6137L4.44433 10.6981ZM15.5531 10.6981L16.2983 10.6137L15.5531 10.6981ZM16.2858 12.3994L16.8574 11.9138L16.2858 12.3994ZM15.2657 8.16105L14.5204 8.24547V8.24547L15.2657 8.16105ZM4.73173 8.16105L5.47696 8.24547L4.73173 8.16105ZM13.201 16.9292C13.3464 16.5414 13.1498 16.1091 12.7619 15.9637C12.374 15.8184 11.9418 16.0149 11.7964 16.4028L12.4987 16.666L13.201 16.9292ZM8.201 16.4028C8.05563 16.0149 7.62336 15.8184 7.23549 15.9637C6.84763 16.1091 6.65104 16.5414 6.7964 16.9292L7.4987 16.666L8.201 16.4028ZM3.3748 4.87106L4.08631 5.10823L4.08631 5.10823L3.3748 4.87106ZM2.62052 4.76218C2.48953 5.15513 2.7019 5.57988 3.09486 5.71086C3.48782 5.84185 3.91256 5.62948 4.04354 5.23652L3.33203 4.99935L2.62052 4.76218ZM6.90254 2.37753C7.29549 2.24654 7.50786 1.8218 7.37688 1.42884C7.24589 1.03589 6.82115 0.823517 6.42819 0.954503L6.66536 1.66602L6.90254 2.37753ZM6.53707 1.70878L6.2999 0.997267H6.2999L6.53707 1.70878ZM16.6226 4.87106L15.9111 5.10823L15.9539 5.23652L16.6654 4.99935L17.3769 4.76218L17.3341 4.63388L16.6226 4.87106ZM13.332 1.66602L13.0949 2.37753L13.2232 2.42029L13.4603 1.70878L13.6975 0.997267L13.5692 0.954503L13.332 1.66602ZM16.6226 4.87106L17.3341 4.63389C16.7618 2.91691 15.4145 1.56959 13.6975 0.997267L13.4603 1.70878L13.2232 2.42029C14.4922 2.84332 15.4881 3.83916 15.9111 5.10823L16.6226 4.87106ZM15.1403 14.9993V14.2493H4.85714V14.9993V15.7493H15.1403V14.9993ZM15.2657 8.16105L14.5204 8.24547L14.8078 10.7825L15.5531 10.6981L16.2983 10.6137L16.0109 8.07662L15.2657 8.16105ZM4.44433 10.6981L5.18956 10.7825L5.47696 8.24547L4.73173 8.16105L3.98649 8.07662L3.6991 10.6137L4.44433 10.6981ZM3.71161 12.3994L4.28318 12.885C4.78668 12.2924 5.1016 11.559 5.18956 10.7825L4.44433 10.6981L3.6991 10.6137C3.64423 11.098 3.44816 11.5511 3.14004 11.9138L3.71161 12.3994ZM15.5531 10.6981L14.8078 10.7825C14.8958 11.559 15.2107 12.2924 15.7142 12.885L16.2858 12.3994L16.8574 11.9138C16.5492 11.5511 16.3532 11.098 16.2983 10.6137L15.5531 10.6981ZM4.85714 14.9993V14.2493C4.23191 14.2493 3.80761 13.4447 4.28318 12.885L3.71161 12.3994L3.14004 11.9138C1.89326 13.3813 2.86684 15.7493 4.85714 15.7493V14.9993ZM15.1403 14.9993V15.7493C17.1306 15.7493 18.1041 13.3813 16.8574 11.9138L16.2858 12.3994L15.7142 12.885C16.1898 13.4447 15.7655 14.2493 15.1403 14.2493V14.9993ZM15.2657 8.16105L16.0109 8.07662C15.6581 4.96227 13.0884 2.58268 9.9987 2.58268V3.33268V4.08268C12.2908 4.08268 14.2496 5.85452 14.5204 8.24547L15.2657 8.16105ZM4.73173 8.16105L5.47696 8.24547C5.74781 5.85452 7.70664 4.08268 9.9987 4.08268V3.33268V2.58268C6.90899 2.58268 4.33929 4.96227 3.98649 8.07662L4.73173 8.16105ZM12.4987 16.666L11.7964 16.4028C11.5465 17.0697 10.8524 17.5827 9.9987 17.5827V18.3327V19.0827C11.4533 19.0827 12.7231 18.2043 13.201 16.9292L12.4987 16.666ZM9.9987 18.3327V17.5827C9.14495 17.5827 8.45093 17.0697 8.201 16.4028L7.4987 16.666L6.7964 16.9292C7.27427 18.2043 8.54406 19.0827 9.9987 19.0827V18.3327ZM3.3748 4.87106L2.66328 4.63389L2.62052 4.76218L3.33203 4.99935L4.04354 5.23652L4.08631 5.10823L3.3748 4.87106ZM6.66536 1.66602L6.42819 0.954503L6.2999 0.997267L6.53707 1.70878L6.77424 2.42029L6.90254 2.37753L6.66536 1.66602ZM3.3748 4.87106L4.08631 5.10823C4.50933 3.83916 5.50517 2.84332 6.77424 2.42029L6.53707 1.70878L6.2999 0.997267C4.58292 1.56959 3.23561 2.91691 2.66328 4.63389L3.3748 4.87106Z" fill="#60607C"/>
                                                </svg>
                                            {{else}}
                                                {{#if (eq this.defectStatus "IN_PROGRESS")}}
                                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path d="M11.6657 3.33268C11.6657 4.25316 10.9195 4.99935 9.999 4.99935C9.07853 4.99935 8.33234 4.25316 8.33234 3.33268C8.33234 2.41221 9.07853 1.66602 9.999 1.66602C10.9195 1.66602 11.6657 2.41221 11.6657 3.33268Z" stroke="white" stroke-width="1.5"/>
                                                        <path d="M11.6657 16.666C11.6657 17.5865 10.9195 18.3327 9.999 18.3327C9.07853 18.3327 8.33234 17.5865 8.33234 16.666C8.33234 15.7455 9.07853 14.9993 9.999 14.9993C10.9195 14.9993 11.6657 15.7455 11.6657 16.666Z" stroke="white" stroke-width="1.5"/>
                                                        <path d="M16.6059 8.10939C15.8087 8.56962 14.7894 8.2965 14.3291 7.49935C13.8689 6.70219 14.142 5.68287 14.9392 5.22264C15.7363 4.7624 16.7557 5.03552 17.2159 5.83268C17.6761 6.62983 17.403 7.64915 16.6059 8.10939Z" stroke="white" stroke-width="1.5"/>
                                                        <path d="M5.05887 14.7761C4.26172 15.2363 3.2424 14.9632 2.78216 14.166C2.32193 13.3689 2.59505 12.3495 3.39221 11.8893C4.18936 11.4291 5.20868 11.7022 5.66891 12.4993C6.12915 13.2965 5.85603 14.3158 5.05887 14.7761Z" stroke="white" stroke-width="1.5"/>
                                                        <path d="M14.9392 14.7761C14.142 14.3158 13.8689 13.2965 14.3291 12.4993C14.7894 11.7022 15.8087 11.4291 16.6059 11.8893C17.403 12.3495 17.6761 13.3689 17.2159 14.166C16.7557 14.9632 15.7363 15.2363 14.9392 14.7761Z" stroke="white" stroke-width="1.5"/>
                                                        <path d="M3.39221 8.10941C2.59505 7.64918 2.32193 6.62986 2.78216 5.8327C3.2424 5.03555 4.26172 4.76242 5.05887 5.22266C5.85603 5.6829 6.12915 6.70222 5.66891 7.49937C5.20868 8.29653 4.18936 8.56965 3.39221 8.10941Z" stroke="white" stroke-width="1.5"/>
                                                    </svg>
                                                {{else}}
                                                    {{#if (eq this.defectStatus "IN_REVIEW")}}
                                                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                            <path d="M11.6657 3.33268C11.6657 4.25316 10.9195 4.99935 9.999 4.99935C9.07853 4.99935 8.33234 4.25316 8.33234 3.33268C8.33234 2.41221 9.07853 1.66602 9.999 1.66602C10.9195 1.66602 11.6657 2.41221 11.6657 3.33268Z" stroke="white" stroke-width="1.5"/>
                                                            <path d="M11.6657 16.666C11.6657 17.5865 10.9195 18.3327 9.999 18.3327C9.07853 18.3327 8.33234 17.5865 8.33234 16.666C8.33234 15.7455 9.07853 14.9993 9.999 14.9993C10.9195 14.9993 11.6657 15.7455 11.6657 16.666Z" stroke="white" stroke-width="1.5"/>
                                                            <path d="M16.6059 8.10939C15.8087 8.56962 14.7894 8.2965 14.3291 7.49935C13.8689 6.70219 14.142 5.68287 14.9392 5.22264C15.7363 4.7624 16.7557 5.03552 17.2159 5.83268C17.6761 6.62983 17.403 7.64915 16.6059 8.10939Z" stroke="white" stroke-width="1.5"/>
                                                            <path d="M5.05887 14.7761C4.26172 15.2363 3.2424 14.9632 2.78216 14.166C2.32193 13.3689 2.59505 12.3495 3.39221 11.8893C4.18936 11.4291 5.20868 11.7022 5.66891 12.4993C6.12915 13.2965 5.85603 14.3158 5.05887 14.7761Z" stroke="white" stroke-width="1.5"/>
                                                            <path d="M14.9392 14.7761C14.142 14.3158 13.8689 13.2965 14.3291 12.4993C14.7894 11.7022 15.8087 11.4291 16.6059 11.8893C17.403 12.3495 17.6761 13.3689 17.2159 14.166C16.7557 14.9632 15.7363 15.2363 14.9392 14.7761Z" stroke="white" stroke-width="1.5"/>
                                                            <path d="M3.39221 8.10941C2.59505 7.64918 2.32193 6.62986 2.78216 5.8327C3.2424 5.03555 4.26172 4.76242 5.05887 5.22266C5.85603 5.6829 6.12915 6.70222 5.66891 7.49937C5.20868 8.29653 4.18936 8.56965 3.39221 8.10941Z" stroke="white" stroke-width="1.5"/>
                                                        </svg>
                                                    {{else}}
                                                        {{#if (eq this.defectStatus "NOT_FIXED")}}
                                                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M8.30796 3.4716C9.04601 2.17613 10.9566 2.17613 11.6946 3.4716L18.0881 14.6937C18.8054 15.9527 17.8718 17.5 16.3947 17.5H3.60787C2.13085 17.5 1.19722 15.9527 1.91453 14.6937L8.30796 3.4716ZM10.8346 14.1667C10.8346 14.6269 10.4615 15 10.0013 15C9.54101 15 9.16792 14.6269 9.16792 14.1667C9.16792 13.7064 9.54101 13.3333 10.0013 13.3333C10.4615 13.3333 10.8346 13.7064 10.8346 14.1667ZM10.6263 7.5C10.6263 7.15482 10.3464 6.875 10.0013 6.875C9.65607 6.875 9.37625 7.15482 9.37625 7.5V11.6667C9.37625 12.0118 9.65607 12.2917 10.0013 12.2917C10.3464 12.2917 10.6263 12.0118 10.6263 11.6667V7.5Z" fill="white"/>
                                                            </svg>
                                                        {{else}}
                                                            {{#if (eq this.defectStatus "FIXED")}}
                                                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M10.0013 18.3327C14.6037 18.3327 18.3346 14.6017 18.3346 9.99935C18.3346 5.39698 14.6037 1.66602 10.0013 1.66602C5.39893 1.66602 1.66797 5.39698 1.66797 9.99935C1.66797 14.6017 5.39893 18.3327 10.0013 18.3327ZM13.828 7.88309C14.0399 7.61062 13.9908 7.21795 13.7184 7.00603C13.4459 6.79411 13.0532 6.8432 12.8413 7.11566L9.50213 11.4089C9.42788 11.5043 9.28821 11.5167 9.19831 11.4358L7.08608 9.53482C6.82951 9.30391 6.43433 9.32471 6.20342 9.58127C5.9725 9.83784 5.9933 10.233 6.24987 10.4639L8.36211 12.3649C8.99138 12.9313 9.96906 12.8446 10.4888 12.1763L13.828 7.88309Z" fill="white"/>
                                                                </svg>
                                                            {{/if}}
                                                        {{/if}}
                                                    {{/if}}
                                                {{/if}}
                                            {{/if}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="card__title fs-14" style="margin-bottom: 4px;">
                                    {{#if (eq this.defectStatus "NEW")}}Новый
                                    {{else}}{{#if (eq this.defectStatus "IN_PROGRESS")}}В процессе
                                    {{else}}{{#if (eq this.defectStatus "IN_REVIEW")}}Проверка
                                    {{else}}{{#if (eq this.defectStatus "NOT_FIXED")}}Не устранено
                                    {{else}}{{#if (eq this.defectStatus "FIXED")}}Устранено
                                    {{/if}}{{/if}}{{/if}}{{/if}}{{/if}}
                                </div>
                                <div class="card__description">
                                    Замечание в статусе
                                    {{#if (eq this.defectStatus "NEW")}}“Новый”
                                    {{else}}{{#if (eq this.defectStatus "IN_PROGRESS")}}“В процессе”
                                    {{else}}{{#if (eq this.defectStatus "IN_REVIEW")}}“Проверка”
                                    {{else}}{{#if (eq this.defectStatus "NOT_FIXED")}}“Не устранено”
                                    {{else}}{{#if (eq this.defectStatus "FIXED")}}“Устранено”
                                    {{/if}}{{/if}}{{/if}}{{/if}}{{/if}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Images + Detail + Info -->
                <div class="d-flex mb-10">
                    <!-- Images -->
                    <div class="w-422">
                        <div class="images">
                            <div class="image">
                                {{#if this.beforeImageUuid}}
                                    <img src="{{../downloadUrl}}{{this.beforeImageUuid}}" alt="До"/>
                                {{/if}}
                                <div class="image__title">До</div>
                            </div>
                            <div class="image">
                                {{#if this.afterImageUuid}}
                                    <img src="{{../downloadUrl}}{{this.afterImageUuid}}" alt="После"/>
                                {{/if}}
                                <div class="image__title">После</div>
                            </div>
                        </div>
                    </div>

                    <!-- Detail + Info -->
                    <div class="w-full">
                        <div class="detail">
                            <h3 class="detail__title">Дополнительные данные</h3>
                            <p class="detail__description">Дополнительные данные по замечанию</p>

                            <div class="detail__item">
                                <strong class="detail__item-key">Тип документа</strong>
                                <span class="detail__item-value">
                                    {{#if (eq this.defectType "NORMAL")}}Обычный
                                    {{else}}{{#if (eq this.defectType "CRITICAL")}}Критичный
                                    {{else}}{{#if (eq this.defectType "RECOMMENDATION")}}Рекомендация
                                    {{/if}}{{/if}}{{/if}}
                                </span>
                            </div>
                            <div class="detail__item">
                                <strong class="detail__item-key">Очередь</strong>
                                <span class="detail__item-value">{{this.queueName}}</span>
                            </div>
                            <div class="detail__item">
                                <strong class="detail__item-key">Секция</strong>
                                <span class="detail__item-value">{{this.sectionName}}</span>
                            </div>
                            <div class="detail__item">
                                <strong class="detail__item-key">Этаж</strong>
                                <span class="detail__item-value">{{this.targetName}}</span>
                            </div>
                            <div class="detail__item">
                                <strong class="detail__item-key">Вид работ</strong>
                                <span class="detail__item-value">{{this.workTypeName}}</span>
                            </div>
                            <div class="detail__item">
                                <strong class="detail__item-key">Причины возникновения</strong>
                                <span class="detail__item-value">{{this.factorName}}</span>
                            </div>
                            <div class="detail__item">
                                <strong class="detail__item-key">Дата выявления</strong>
                                <span class="detail__item-value">{{this.detectedDate}}</span>
                            </div>
                            <div class="detail__item">
                                <strong class="detail__item-key">Срок</strong>
                                <span class="detail__item-value">{{this.dueDate}}</span>
                            </div>
                            <div class="detail__item">
                                <strong class="detail__item-key">Дата устранения</strong>
                                <span class="detail__item-value">{{this.resolvedDate}}</span>
                            </div>

                            <div class="numbers">
                                {{#each (range 1 10)}}
                                    <div class="number{{#if (eq this ../this.criticalLevel)}} active{{/if}}">{{this}}</div>
                                {{/each}}
                            </div>
                        </div>

                        <div class="info">
                            <div class="info__item">
                                <h4 class="info__item-title">Описание</h4>
                                <p class="info__item-description">{{this.description}}</p>
                            </div>
                            <div class="info__item">
                                <h4 class="info__item-title">Мероприятия по устранению</h4>
                                <p class="info__item-description">{{this.measures}}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Users -->
                <div class="d-flex">
                    <div class="w-422" style="padding-right: 60px;">
                        <h3 class="user__title">Выдал замечание</h3>
                        <div class="user__item">
                            <h4 class="user__item-value">Отчет составил ОТН</h4>
                            <h4 class="user__item-value">{{this.technical.fullName}}</h4>
                        </div>
                    </div>
                    <div class="w-full">
                        <h3 class="user__title">Принял замечание</h3>
                        <div class="d-flex" style="column-gap: 50px;">
                            <div style="width: 100%;">
                                <div class="user__item">
                                    <div>
                                        <h4 class="user__item-value">{{this.contractor.name}}</h4>
                                        <p class="user__item-key">Генподрядчик</p>
                                    </div>
                                    <div>
                                        <h4 class="user__item-value">{{this.contractor.user.fullName}}</h4>
                                        <p class="user__item-key">Ф.И.О</p>
                                    </div>
                                </div>
                                <div class="user__item">
                                    <div>
                                        <h4 class="user__item-value">{{this.subContractor.name}}</h4>
                                        <p class="user__item-key">Субподрядчик</p>
                                    </div>
                                    <div>
                                        <h4 class="user__item-value">{{this.subContractor.user.fullName}}</h4>
                                        <p class="user__item-key">Ф.И.О</p>
                                    </div>
                                </div>
                            </div>
                            <div style="width: 100%;">
                                <div class="user__item">
                                    <h4 class="user__item-value">РП объекта</h4>
                                    <h4 class="user__item-value">{{this.manager.fullName}}</h4>
                                </div>
                                <div class="user__item">
                                    <h4 class="user__item-value">ЗРП объекта</h4>
                                    <h4 class="user__item-value">{{this.managerAssistant.fullName}}</h4>
                                </div>
                                <div class="user__item">
                                    <h4 class="user__item-value">Прораб объекта</h4>
                                    <h4 class="user__item-value">{{this.foreman.fullName}}</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {{/each}}
    </body>
</html>
